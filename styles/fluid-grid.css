/**
 * Squarespace-inspired Fluid Engine Grid System
 * 
 * This CSS implements a responsive grid system similar to Squarespace's Fluid Engine.
 * 
 * Usage:
 * - Wrap content in a .fluid-engine container
 * - Place items in .grid-block elements
 * - Use custom properties to position blocks with grid-area
 */

/* ============================================
   CSS CUSTOM PROPERTIES
   ============================================ */
:root {
  --sqs-site-max-width: 1500px;
  --sqs-site-gutter: 4vw;
  --sqs-mobile-site-gutter: 6vw;
}

/* ============================================
   FLUID ENGINE CONTAINER
   Mobile-first (8-column grid)
   ============================================ */
.fluid-engine {
  --grid-gutter: calc(var(--sqs-mobile-site-gutter, 6vw) - 11px);
  --cell-max-width: calc((var(--sqs-site-max-width, 1500px) - (11px * 7)) / 8);

  display: grid;
  position: relative;
  grid-area: 1/1/-1/-1;
  
  /* Mobile: 30 rows, minimum 24px each */
  grid-template-rows: repeat(30, minmax(24px, auto));
  
  /* Mobile: 8 content columns + 2 gutter columns */
  grid-template-columns:
    minmax(var(--grid-gutter), 1fr)
    repeat(8, minmax(0, var(--cell-max-width)))
    minmax(var(--grid-gutter), 1fr);
  
  row-gap: 11px;
  column-gap: 11px;
  
  /* Prevent horizontal scroll */
  overflow-x: hidden;
  overflow-x: clip;
}

/* ============================================
   DESKTOP BREAKPOINT (â‰¥ 768px)
   24-column grid with scaled rows
   ============================================ */
@media (min-width: 768px) {
  .fluid-engine {
    --grid-gutter: calc(var(--sqs-site-gutter, 4vw) - 11px);
    --cell-max-width: calc((var(--sqs-site-max-width, 1500px) - (11px * 23)) / 24);
    --inset-padding: 0vw;
    
    /* Row height scales with container width (2.15% ratio) */
    --row-height-scaling-factor: 0.0215;
    --container-width: min(
      var(--sqs-site-max-width, 1500px), 
      calc(100vw - var(--sqs-site-gutter, 4vw) * 2 - var(--inset-padding))
    );
    
    /* Desktop: 25 rows, height scales with container width */
    grid-template-rows: repeat(25, minmax(calc(var(--container-width) * var(--row-height-scaling-factor)), auto));
    
    /* Desktop: 24 content columns + 2 gutter columns */
    grid-template-columns:
      minmax(var(--grid-gutter), 1fr)
      repeat(24, minmax(0, var(--cell-max-width)))
      minmax(var(--grid-gutter), 1fr);
  }

  /* Inset padding variant for full-bleed sections */
  .background-width--inset .fluid-engine {
    --inset-padding: calc(var(--sqs-site-gutter) * 2);
  }
}

/* ============================================
   GRID BLOCK
   Individual content blocks within the grid
   ============================================ */
.grid-block {
  /* Use CSS custom properties for flexible positioning */
  grid-area: var(--mobile-grid-area, auto);
  z-index: var(--block-z-index, 1);
  
  /* Default alignment */
  display: flex;
  flex-direction: column;
  justify-content: var(--block-justify, flex-start);
  align-items: var(--block-align, flex-start);
}

@media (min-width: 768px) {
  .grid-block {
    grid-area: var(--desktop-grid-area, var(--mobile-grid-area, auto));
  }
}

/* ============================================
   HELPER CLASSES
   ============================================ */

/* Center-aligned block */
.grid-block--center {
  justify-content: center;
  align-items: center;
}

/* Right-aligned block */
.grid-block--right {
  justify-content: flex-start;
  align-items: flex-end;
}

/* Bottom-aligned block */
.grid-block--bottom {
  justify-content: flex-end;
  align-items: flex-start;
}

/* Stretched block (fills entire cell) */
.grid-block--stretch {
  width: 100%;
  height: 100%;
}

/* ============================================
   USAGE EXAMPLES
   ============================================ */

/*
Example 1: Image on left, text on right (like "Leading from the front")

<div class="fluid-engine">
  <div class="grid-block grid-block--image" style="
    --mobile-grid-area: 1/2/9/10;
    --desktop-grid-area: 1/2/23/14;
    --block-z-index: 1;
  ">
    <img src="..." alt="..." />
  </div>
  
  <div class="grid-block grid-block--text" style="
    --mobile-grid-area: 9/2/27/10;
    --desktop-grid-area: 1/15/22/24;
    --block-z-index: 2;
  ">
    <h2>Heading</h2>
    <p>Content...</p>
  </div>
</div>

---

Example 2: Using in React/Next.js with CSS modules

// Component.tsx
<div className="fluid-engine">
  <div 
    className="grid-block" 
    style={{
      '--mobile-grid-area': '1/2/9/10',
      '--desktop-grid-area': '1/2/23/14',
      '--block-z-index': 1
    } as React.CSSProperties}
  >
    ...
  </div>
</div>

---

Example 3: Three-column layout on desktop

<div class="fluid-engine">
  <div class="grid-block" style="
    --mobile-grid-area: 1/2/10/10;
    --desktop-grid-area: 1/2/20/10;
  ">Column 1</div>
  
  <div class="grid-block" style="
    --mobile-grid-area: 10/2/19/10;
    --desktop-grid-area: 1/10/20/18;
  ">Column 2</div>
  
  <div class="grid-block" style="
    --mobile-grid-area: 19/2/28/10;
    --desktop-grid-area: 1/18/20/26;
  ">Column 3</div>
</div>

*/

/* ============================================
   GRID AREA CHEATSHEET
   ============================================ */

/*
grid-area syntax: row-start / col-start / row-end / col-end

Mobile Grid (8 columns):
- Gutter: column 1
- Content: columns 2-9
- Gutter: column 10
- Full width: 2/10
- Half width: 2/6 or 6/10
- Third: 2/4, 4/7, 7/10

Desktop Grid (24 columns):
- Gutter: column 1
- Content: columns 2-25
- Gutter: column 26
- Full width: 2/26
- Half width: 2/14 or 14/26
- Third: 2/10, 10/18, 18/26
- Quarter: 2/8, 8/14, 14/20, 20/26

Common Desktop Layouts:
- 50/50: [1/2/x/14] and [1/14/x/26]
- 60/40: [1/2/x/16] and [1/16/x/26]
- 40/60: [1/2/x/12] and [1/12/x/26]
- 33/33/33: [1/2/x/10], [1/10/x/18], [1/18/x/26]

Replace 'x' with desired row end (usually 20-25 for full height)
*/

/* ============================================
   DEBUGGING
   Uncomment to visualize the grid
   ============================================ */

/*
.fluid-engine {
  background-image: 
    repeating-linear-gradient(
      to right,
      rgba(255, 0, 0, 0.1) 0,
      rgba(255, 0, 0, 0.1) 1px,
      transparent 1px,
      transparent
    );
  background-size: calc(100% / 8) 100%;
}

@media (min-width: 768px) {
  .fluid-engine {
    background-size: calc(100% / 24) 100%;
  }
}

.grid-block {
  outline: 2px dashed rgba(0, 100, 255, 0.5);
  background-color: rgba(0, 100, 255, 0.05);
}
*/

